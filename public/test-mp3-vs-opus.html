<!DOCTYPE html>
<html>
<head>
  <title>MP3 vs Opus Test</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .player { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
    audio { width: 100%; }
    h2 { margin-top: 0; }
    .info { color: #666; font-size: 14px; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Audio Format Comparison Test</h1>

  <div class="player">
    <h2>MP3 File</h2>
    <audio id="mp3" controls preload="auto" src="https://prediciduminica-r2.lightsongjs.workers.dev/audio/2026-02-01_Vamesului_si_Fariseului_2016.mp3">
    </audio>
    <div class="info" id="mp3-info">Loading...</div>
  </div>

  <div class="player">
    <h2>Opus File</h2>
    <audio id="opus" controls preload="auto" src="https://prediciduminica-r2.lightsongjs.workers.dev/audio/Despre%20fratele%20fiului%20risipitor.opus">
    </audio>
    <div class="info" id="opus-info">Loading...</div>
  </div>

  <script>
    function updateInfo(id, audio) {
      const info = document.getElementById(id + '-info');
      const update = () => {
        info.innerHTML = `Duration: ${audio.duration?.toFixed(2) || 'N/A'}s | ` +
          `Current: ${audio.currentTime?.toFixed(2)}s | ` +
          `ReadyState: ${audio.readyState} | ` +
          `Buffered: ${audio.buffered.length > 0 ? audio.buffered.end(audio.buffered.length-1).toFixed(2) + 's' : 'none'}`;
      };

      audio.addEventListener('loadedmetadata', () => {
        console.log(`[${id}] Metadata loaded, duration: ${audio.duration}`);
        update();
      });
      audio.addEventListener('durationchange', () => {
        console.log(`[${id}] Duration changed: ${audio.duration}`);
        update();
      });
      audio.addEventListener('canplaythrough', () => {
        console.log(`[${id}] Can play through`);
        update();
      });
      audio.addEventListener('timeupdate', update);
      audio.addEventListener('error', (e) => {
        console.error(`[${id}] Error:`, audio.error);
        info.innerHTML = `Error: ${audio.error?.message || 'Unknown error'}`;
      });
    }

    updateInfo('mp3', document.getElementById('mp3'));
    updateInfo('opus', document.getElementById('opus'));
  </script>
</body>
</html>
